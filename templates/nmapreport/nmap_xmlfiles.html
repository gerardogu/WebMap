{% extends "nmapreport/main.html" %}

{% block content %}
	<div class="container" style="margin-top:30px;">
		<div class="row">
			<div class="col s12 m3">
				<div class="card darken-1">
					<div class="card-content grey darken-3 white-text">
						<span class="card-title"><i class="fas fa-file-code"></i> {{ stats.xmlcount }}</span>
						<p>XML Files</p>
					</div>
				</div>
			</div>
			<div class="col s12 m3">
				<div class="card darken-1">
					<div class="card-content green darken-1 white-text">
						<span class="card-title"><i class="fas fa-door-open"></i> {{ stats.po }}</span>
						<p>Open ports</p>
					</div>
				</div>
			</div>
			<div class="col s12 m3">
				<div class="card darken-1">
					<div class="card-content red darken-1 white-text">
						<span class="card-title"><i class="fas fa-door-closed"></i> {{ stats.pc }}</span>
						<p>Closed ports</p>
					</div>
				</div>
			</div>
			<div class="col s12 m3">
				<div class="card darken-1">
					<div class="card-content grey darken-1 white-text">
						<span class="card-title"><i class="fas fa-filter"></i> {{ stats.pf }}</span>
						<p>Filtered ports</p>
					</div>
				</div>
			</div>
		</div>

		<div class="card">
			<h4>Results </h4>
		<div class="card-content">
		<table>
			<thead><tr>
				<th>Filename</th>
				<th class="hide-on-small-only">Timestamp</th>
				<th class="hide-on-small-only">Host Count</th>
				<th>Stats</th>
				<th>&nbsp;</th>
			</tr></thead>
			<tbody>
				{% for i,v in tr.items %}
					<tr>
						<td><b><a href="{{ v.href }}">{{ v.filename }}</a></b></td>
						<td class="hide-on-small-only"><code>{{ v.startstr }}</code></td>
						<td class="hide-on-small-only">{{ v.hostnum }}</td>
						<td>
							<i class="fas fa-door-open green-text"></i><span class="green-text">{{ v.portstats.po }}</span> 
							<i class="fas fa-door-closed red-text"></i><span class="red-text">{{ v.portstats.pc }}</span>
							<i class="fas fa-filter grey-text"></i><span class="grey-text">{{ v.portstats.pf }}</span>
						</td>
						<td><a href="{{ v.href }}" class="wbtn-small waves-effect waves-light blue">view</a></td>
					</tr>
				{% endfor %}
			</tbody>
		</table>
		</div>
		</div>

		<br><br>
		<div class="small grey-text">
			{{ webmapver|safe }}
		</div>

	</div>
{% endblock %}
